<script setup>
import { inject, onMounted, onUnmounted, ref, watch } from 'vue';
import { storeToRefs } from 'pinia';
import { useSettingStore } from '../store/settingStore';
import { useAppCommonStore } from '../store/appCommonStore';
import SearchBar from '../components/SearchBar.vue';
import Navigator from '../components/Navigator.vue';
import WinNonMacOSControlBtn from '../components/WinNonMacOSControlBtn.vue';
import { onEvents, emitEvents, offEvents } from '../../common/EventBusWrapper';
import { ipcRendererSend } from '../../common/Utils';



const { 
    visitThemes, visitUserHome, visitSetting, 
    visitModulesSetting, visitPlugins, visitVideoCreate 
} = inject('appRoute')
const { 
    searchAction, searchBarPlaceholder, useWindowsStyleWinCtl, 
    searchDefault,
} = inject('appCommon')
const { hasNewRelease } = inject('appVersion')


const { 
    setLayoutIndex, switchToSimpleLayout, 
    switchToMiniLayout, switchThemeNativeMode 
} = useSettingStore()
const { 
    isRadioModeShortcutEnable,
    isModulesSettingShortcutEnable,
    isPluginsSettingShortcutEnable,
    isThemesShortcutEnable,
    isUserHomeShortcutEnable,
    isSimpleLayoutShortcutEnable, 
    isFreeVideoShortcutEnable,
    isCloudStorageShortcutEnable,
    isUpdatesHintShowEnable,
    isSimpleLayoutShortcutForMiniLayoutEnable,
    isThemeNativeModeShortcutEnable, 
    themeNativeMode 
} = storeToRefs(useSettingStore())
const { 
    isMaxScreen, isRadioMode, isRadioModeEnable, 
    isCloudStorageModeEnable, searchInPageMode,
} = storeToRefs(useAppCommonStore())
const { setSearchInPageMode } = useAppCommonStore()



const toggleRadioMode = () => {
    emitEvents('toggleRadioMode')
}

const visitCloudStorage = () => {
    emitEvents('visitCloudStorageMode')
}

const searchBarRef = ref(null)
const findNextKeyword = (forward) => {
    if(!searchInPageMode.value) return 
    const searchBar = searchBarRef.value
    if(!searchBar) return 

    const keyword = searchBar.getKeyword()
    searchDefault(keyword, {
        forward,
        findNext: true
    })
}

const onKeywodClear = () => {
    setSearchInPageMode(false)
    ipcRendererSend('app-stopFindInPage')
}

const switchToSmallLayout = () => {
    if(isSimpleLayoutShortcutForMiniLayoutEnable.value) {
        switchToMiniLayout()
    } else {
        switchToSimpleLayout()
    }
}

const visitSettingUpdates = () => {
    visitSetting(hasNewRelease.value ? '版本' : null)
}

const eventsRegistration = {
    'app-findInPage': findNextKeyword,
}

onMounted(() => onEvents(eventsRegistration))
onUnmounted(() => offEvents(eventsRegistration))
</script>

<template>
    <div class="classic-main-top">
        <Navigator :refreshable="false"></Navigator>
        <SearchBar ref="searchBarRef"
            :submitAction="searchAction" 
            :placeholder="searchBarPlaceholder"
            :onClearAction="onKeywodClear">
            <template #suffix>
                <div class="extra-action" v-show="searchInPageMode">
                    <svg @click="() => findNextKeyword(false)" width="12" height="12" viewBox="0 0 455.71 818.05" xmlns="http://www.w3.org/2000/svg">
                        <g id="Layer_2" data-name="Layer 2">
                            <g id="Layer_1-2" data-name="Layer 1">
                                <path
                                    d="M101.17,405.1c2.89,1.94,5,2.89,6.47,4.41Q274.29,576.23,440.9,743c13.06,13.06,18.24,28.17,12.47,46-9.58,29.54-46.92,38.79-69.57,17.37-7.87-7.44-15.35-15.29-23-23L15.22,437.44C-5,417.2-5.07,392.34,15,372.23Q193.44,193.58,371.81,14.88C380.93,5.74,391.29-.19,404.44,0c17.18.25,30.24,8,37.94,23.27,7.79,15.43,6.19,30.66-3.89,44.78a60.83,60.83,0,0,1-6.7,7.4Q269.45,238,107.05,400.5C105.77,401.78,104.18,402.76,101.17,405.1Z" />
                            </g>
                        </g>
                    </svg>
                    <svg @click="() => findNextKeyword(true)" width="12" height="12" 
                        viewBox="0 0 455.71 818.08" xmlns="http://www.w3.org/2000/svg">
                        <g id="Layer_2" data-name="Layer 2">
                            <g id="Layer_1-2" data-name="Layer 1">
                                <g id="Layer_2-2" data-name="Layer 2">
                                    <g id="Layer_1-2-2" data-name="Layer 1-2">
                                        <path
                                            d="M354.54,413c-2.89-1.94-5-2.89-6.47-4.41Q181.42,241.85,14.81,75.08C1.75,62-3.43,46.91,2.34,29.08,11.92-.46,49.26-9.71,71.91,11.71c7.87,7.44,15.35,15.29,23,23L440.49,380.64c20.22,20.24,20.29,45.1.22,65.21Q262.27,624.5,83.9,803.2c-9.12,9.14-19.48,15.07-32.63,14.88-17.18-.25-30.24-8-37.94-23.27C5.54,779.38,7.14,764.15,17.22,750a61.07,61.07,0,0,1,6.7-7.4q162.34-162.55,324.74-325C349.94,416.3,351.53,415.32,354.54,413Z" />
                                    </g>
                                </g>
                            </g>
                        </g>
                    </svg>
                </div>
            </template>
        </SearchBar>
        <div class="center">
            <div class="action">
                <div class="theme-native-mode-btn btn spacing" @click="switchThemeNativeMode" v-show="isThemeNativeModeShortcutEnable">
                    <svg width="19" height="19" v-show="themeNativeMode == 0" viewBox="0 0 773 843.61" xmlns="http://www.w3.org/2000/svg"><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><path d="M0,451.41c3-9.26,4.88-19.16,9.42-27.61,5.62-10.48,13.2-20,20.41-29.52Q140.44,247.69,251.22,101.2C268,79,284.68,56.74,301.6,34.66,332.06-5.1,387.32-11.81,423.85,20.55,449.29,43.09,458.59,71.71,450.1,105c-15.66,61.42-31.78,122.72-47.7,184.07-.2.78-.31,1.58-.6,3.12h6.11q58,0,116,0c48.06.05,83.89,35,84.72,83.14.31,17.85-5.5,34-16.27,48.36Q509.15,534.35,425.94,645q-59.79,79.47-119.71,158.85c-14.65,19.35-33.68,31.8-58.46,33.06-37.34,1.89-78-16.22-89.75-65.43-3.33-14-2.25-27.73,1.34-41.49q23.52-90.06,46.91-180.16c.37-1.42.64-2.86,1.16-5.21H85.8c-44.46,0-78-28.69-84.83-72.54a14.36,14.36,0,0,0-1-2.65Zm527.25-75.63L526,374.23h-6.44q-84,0-167.93-.06a59.31,59.31,0,0,1-13.36-1.44C313.8,367,301.68,345.06,308.42,319q30.06-116.46,60.21-232.9c.37-1.44.61-2.92.92-4.38l-1.88-.89Q225.25,271.16,82,462.58h7.24q84.7,0,169.43,0c31.14,0,50.17,24.19,42.41,54.27q-30,116.48-60.43,232.84a42.68,42.68,0,0,0-.72,5.43l1.72.75Z"/><path d="M773,803c-1,18.92-13.54,34.94-31.47,39.33-19,4.64-38.22-3.67-46.67-21.16-6.94-14.36-12.79-29.24-19.12-43.9-2.23-5.19-4.62-10.33-6.58-15.63-1-2.7-2.48-3.36-5.17-3.36q-60.72.12-121.44,0c-3.36,0-4.53,1.47-5.68,4.2-8,19-15.88,38.07-24.24,56.92-7.28,16.41-23.43,25.47-41.7,24.12-16.09-1.18-30.64-13.6-35.4-30.19-2.79-9.74-1.46-19.16,2.44-28.28q42.11-98.44,84.3-196.84,20.75-48.4,41.55-96.77c8.07-18.74,23.19-28.55,42.3-26.94,17,1.43,29.2,9.86,36,25.88q53.26,124.56,106.69,249.06c6.48,15.13,13.16,30.18,19.28,45.46C770.45,790.62,771.42,796.92,773,803ZM574.55,675.39h57.33L603.2,608Z"/></g></g></svg>
                    <svg width="20" height="20" v-show="themeNativeMode == 1" style="transform: translateY(0.5px) scale(1.03);" viewBox="0 0 927.77 927.96" xmlns="http://www.w3.org/2000/svg"><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><path d="M464.1,193.94c149.2,0,269.94,121,269.85,270.38C733.86,612.93,613,734.08,464.92,734c-150.36,0-271.17-120.44-271.1-270.15C193.9,314.51,314.58,194,464.1,193.94ZM634.21,464.08c.12-94.11-76-170.28-170.23-170.4-94.1-.13-170.35,76-170.42,170.21a170.33,170.33,0,0,0,340.65.19Z"/><path d="M849.65,415c12.32,0,24.76-1.15,36.91.25,23.26,2.69,41.15,24.61,41.21,48.65.05,24.23-17.88,46.92-41.48,48.78s-47.25.74-70.89.88a21.52,21.52,0,0,1-3.94-.62c-23.22-4.09-40.74-25.56-40.44-49.56.29-23.81,17.94-45.28,41.23-48.11C824.55,413.74,837.17,415,849.65,415Z"/><path d="M414.9,849.49c0-12.48-1.23-25.1.26-37.4,2.83-23.3,24.85-41,48.85-41,23.82.06,45,17.72,48.82,40.71a54.3,54.3,0,0,1,.89,8.42c.08,19.5.3,39,0,58.5-.42,25.68-19.43,46-45.2,48.92-23.87,2.69-47-13.71-52.93-37.84A60.16,60.16,0,0,1,414.05,877c-.22-9.16-.07-18.33-.07-27.5Z"/><path d="M512.94,78.84c0,12.14,1.21,24.44-.26,36.4-2.93,23.9-24.56,41.65-48.78,41.62s-45.26-17.79-49.06-41.56a45.25,45.25,0,0,1-.79-6.94c-.06-19.83-.33-39.66,0-59.49.46-25.37,19.49-45.6,45-48.56,23.93-2.77,47,13.54,53,37.7a62.69,62.69,0,0,1,1.59,13.33c.24,9.16.07,18.33.07,27.5Z"/><path d="M78.18,513.06c-12.14,0-24.45,1.25-36.4-.25C16.64,509.63-1.34,486.55.08,461.16S22,415.09,47.33,414.31q31-1,62,0c26.46.78,47.44,23.24,47.44,49.76a49.88,49.88,0,0,1-47.58,49.7c-10.32.42-20.66.07-31,.07Z"/><path d="M261.18,215c-.84,17.61-10.23,33.45-29.6,42-19.07,8.37-37.58,5.84-53-8.24S148.3,219.54,134,204.2c-18-19.25-16.7-49.69,2-68.26S185,116.2,204.24,134.2c15.19,14.23,29.76,29.15,44.21,44.14C257.24,187.46,261.17,198.86,261.18,215Z"/><path d="M712.94,261.28c-17.77-.91-33.62-10.32-42-29.73s-5.52-38.13,9-53.78c13.82-14.88,28.33-29.16,43.08-43.14,19.32-18.3,49.8-17.51,68.67,1.18s20,49.28,1.89,68.65c-14.23,15.19-29.19,29.71-44.14,44.2C740.56,257.25,728.63,261.36,712.94,261.28Z"/><path d="M214.61,666.68c17.76.77,33.61,10.15,42.15,29.5s5.83,37.87-8.43,53.43c-14.05,15.35-28.92,30-44.13,44.2-19.36,18.09-50.07,16.76-68.63-2.18s-19.33-49.09-1.22-68.3c14.05-14.9,28.72-29.23,43.42-43.5C187,670.87,198.46,666.74,214.61,666.68Z"/><path d="M713.43,666.67c15.87.05,27.44,4.23,36.8,13.35,14.44,14.06,28.85,28.18,42.74,42.78a49.7,49.7,0,0,1-70,70.48c-14.77-13.94-29.25-28.26-43.07-43.15-14.52-15.65-17.44-34.29-9-53.78S695.23,667.56,713.43,666.67Z"/></g></g></svg>
                    <svg width="19" height="19" v-show="themeNativeMode == 2" style="transform: translateY(1px) scale(0.95);" viewBox="0 0 864.23 896.18" xmlns="http://www.w3.org/2000/svg"><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><path d="M452.23,896.18C242.81,896,61.15,751.72,13,547.72,1.1,497.31-3.12,446.42,2.39,394.93Q17.3,255.4,107.94,148C163.27,82.61,232,36.69,313.38,9.93c10.11-3.32,20.28-7,30.71-8.64,18.62-2.9,36-2,50.52,14.06,12.21,13.47,14.32,28.2,10.39,43.94-4,16.17-11,31.57-16.17,47.48a354.38,354.38,0,0,0-15,151.92c8.35,71.48,35.58,134.9,82.4,189.46,55.71,64.93,126,105,210.35,120.13,45.48,8.15,90.82,6.76,136-2.81,33-7,61.5,16.67,61.62,50.47a66.93,66.93,0,0,1-7.64,31.57Q775.23,806.63,607.86,868.94C557.76,887.61,505.69,896.11,452.23,896.18ZM282.64,129C171,187.57,80.85,320.47,98.34,481.44c16.66,153.3,130.07,279.75,282,311.31,143,29.71,276.68-32.48,347.91-123C587.07,667,468.64,614.1,378.65,504.48S259.18,268.62,282.64,129Z"/></g></g></svg>
                </div>
                <div class="radio-playlist-btn btn spacing" @click="toggleRadioMode" v-show="isRadioModeEnable && isRadioModeShortcutEnable">
                    <svg class="radio-btn" v-show="!isRadioMode" width="21" height="18.8" viewBox="0 0 939.22 940.41"
                        xmlns="http://www.w3.org/2000/svg">
                        <g id="Layer_2" data-name="Layer 2">
                            <g id="Layer_1-2" data-name="Layer 1">
                                <path
                                    d="M939.22,475.3c-.9,97-31.58,190.79-93.23,274.28-11,14.94-26,21.46-44.17,17.57-17.94-3.83-29.16-15.54-32.91-33.58-2.65-12.76.67-24.36,8.51-34.79a372.54,372.54,0,0,0,44.34-76.25c24.06-55.71,34.77-113.84,30.76-174.43-7.32-110.58-53.46-202-137.95-273.46C660.59,129,597.94,101.17,528,90.57,439.57,77.16,355.88,92.18,278.55,137c-94.46,54.71-156.23,135.6-181.76,241.82C69.1,494,91.05,600.56,160.19,696.88c14.52,20.23,11.94,42,1.08,55.39-17.84,22-50.46,21.2-67.82-1.74a456.73,456.73,0,0,1-49.39-82C11,597.9-3.13,523.54.58,445.77,9.4,261.1,128.39,97.23,301.09,31.32,363.79,7.39,428.63-3.29,495.52.89Q670.41,11.81,797.09,133.48c70,67.1,113.13,148.84,132.87,243.31C936.29,407,939,437.72,939.22,475.3Z" />
                                <path
                                    d="M469.62,341.83c73-.14,131.64,61.47,127.53,134.23-1.79,31.61-13.84,59.07-35.88,81.92-2.63,2.73-3.35,5-2.4,8.71q40.49,158.88,80.7,317.82c6.34,25.08-7.8,48.55-32.47,54.44-23.71,5.67-47.05-9.34-52.73-34-3.66-15.89-7.33-31.78-10.76-47.72-.62-2.91-1.74-3.72-4.59-3.72q-69.75.12-139.49,0c-3,0-3.85,1.14-4.44,3.88-3.49,16.1-7.16,32.16-10.84,48.22C379.4,926.8,362,940.86,341.38,940.4c-22.11-.5-39.81-14.87-43.33-36.22a48.47,48.47,0,0,1,1.1-19.2q40.07-159.24,80.71-318.33c.95-3.74.11-5.93-2.43-8.7-34-37.1-45.18-80.27-29.43-128.1s50.13-76.5,99.75-86.33a118.4,118.4,0,0,1,12.88-1.65C463.61,341.62,466.62,341.83,469.62,341.83ZM521,768.14,478.31,597.58c-4.38,0-8.41.36-12.34-.09-4.74-.54-6.48,1.21-7.61,5.84-10.73,43.79-21.75,87.5-32.68,131.24-2.76,11.08-5.47,22.18-8.28,33.57ZM426.66,469.63a42.7,42.7,0,0,0,85.4.13c.17-23.46-19.47-43.1-42.89-42.88A42.89,42.89,0,0,0,426.66,469.63Z" />
                                <path
                                    d="M464.77,170.81c147.44.55,270,100.94,297.32,240.39C776.35,484,764.9,553,728.54,617.69c-10.23,18.21-29.86,26.37-49.34,20.88-18.8-5.3-32-23-30.56-42.89a50,50,0,0,1,5.92-19.81c13.67-25,23.17-51.31,26.41-79.59,6.66-58.08-7.16-111-43.06-157.24-36.1-46.54-84-73.64-142.43-81.16C392,244.55,292.93,310,264.53,410.32c-16.5,58.32-9.28,114,20.61,166.81,15,26.51.78,58-28.88,64a42.13,42.13,0,0,1-44.08-19.9c-22.42-38.17-36.09-79.28-39.93-123.43-7-80.53,14.44-152.85,65.09-215.8,46.4-57.68,106.82-92.67,179.56-106.32,6.87-1.29,13.81-2.33,20.76-3C448.27,171.71,458.92,171.2,464.77,170.81Z" />
                            </g>
                        </g>
                    </svg>
                    <svg class="playlist-btn" v-show="isRadioMode" width="20" height="20.5" viewBox="0 -50 895.95 703.92"
                        xmlns="http://www.w3.org/2000/svg">
                        <g id="Layer_2" data-name="Layer 2">
                            <g id="Layer_1-2" data-name="Layer 1">
                                <path
                                    d="M640,424.12v-6.58q0-88.74,0-177.47c.06-28.13,23.63-50.33,51.42-47.73,9.63.9,19.09,4.34,28.48,7.13,46.39,13.79,92.63,28.15,139.14,41.53,33.47,9.63,46.39,45.87,29.44,72.69a47.22,47.22,0,0,1-53,20.5c-31-8.94-61.86-18.42-92.77-27.67-2-.61-4.09-1.17-6.75-1.92V311q0,124.49,0,249a144,144,0,0,1-287.25,13.81C441,495,499,424.34,577.75,416.75,598.8,414.71,619.24,417.27,640,424.12ZM592,608a48,48,0,1,0-48-48A48.07,48.07,0,0,0,592,608Z" />
                                <path
                                    d="M400,96Q224.5,96,49,96C20.9,96-.62,74.16,0,46.47.59,21.86,21,1.09,45.57.05c1.33-.06,2.67,0,4,0H750.48c25.24,0,44.59,16.1,48.86,40.56,4.81,27.6-16.74,54.18-44.92,55.38-2,.08-4,0-6,0Z" />
                                <path
                                    d="M287.78,352q-119.47,0-238.95,0C20.79,352-.7,330,0,302.29.66,277.7,21.13,257,45.75,256c1.17,0,2.34,0,3.5,0q238.71,0,477.42,0c27.85,0,49.4,21.12,49.31,48.2A47.92,47.92,0,0,1,528.74,352c-22,.2-44,0-66,0Z" />
                                <path
                                    d="M191.69,608c-47.82,0-95.65.07-143.47,0A48,48,0,0,1,0,559.19C.31,533.67,21.27,512.47,46.84,512c11.5-.2,23,0,34.49,0q127,0,253.94,0c27.18,0,48.64,21.16,48.71,47.79A48,48,0,0,1,335.65,608Q263.67,608.1,191.69,608Z" />
                            </g>
                        </g>
                    </svg>
                </div>
                <div class="cloud-storage-btn btn spacing" @click="visitCloudStorage" v-show="isCloudStorageModeEnable && isCloudStorageShortcutEnable">
                    <svg width="19" height="18" viewBox="0 0 945.36 902.63" xmlns="http://www.w3.org/2000/svg"><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><path d="M0,728.31v-39c1.16-6.32,2.29-12.65,3.5-19,7.89-41.22,27.3-76.11,57.75-104.91,2.61-2.46,5.38-4.74,8.38-7.37l-4.74-4.29Q17.58,511.05,4.54,448.68c-1.75-8.43-3-16.95-4.54-25.43v-41A20.28,20.28,0,0,0,.92,379c1.47-12.23,2.76-24.49,4.34-36.71C13.46,278.49,21.45,214.71,30.09,151c5.24-38.71,21.14-72.75,48.33-101C108.53,18.7,146.47,4.48,189,2.36,223.4.65,257.91.13,292.38.09Q510.15-.18,727.91.28a346.52,346.52,0,0,1,42.82,2.87c70.32,8.93,123.61,57.5,139.48,126.27,9.46,41,13.21,82.84,18.84,124.4,4.11,30.37,7.87,60.78,11.72,91.18,3.45,27.3,6.22,54.63,3.46,82.2-3.93,39.16-17.64,74.31-43.1,104.54-7.58,9-15.88,17.39-24,26.18,2.67,2.87,5.21,5.74,7.9,8.46,17.63,17.75,32.51,37.46,43,60.28,15.63,33.93,19.79,69.47,15.13,106.33-5.58,44.09-24.13,81.94-55.75,112.9-39.21,38.4-86.61,56.83-141.7,56.73q-260-.43-520-.15c-15.65,0-31.35-.06-46.94-1.24C136,898,97.82,882.88,65.5,854.33,36.15,828.41,18.38,795.21,7.23,758.2,4.28,748.4,2.38,738.28,0,728.31Zm472.55,82.85v-.34q134.51,0,269-.06a207.28,207.28,0,0,0,24.9-1.54C820,802.66,861.54,747,852.83,693.68c-8.83-54.1-51.33-90.22-106.2-90.22q-272.28,0-544.55.08a128.49,128.49,0,0,0-25.34,2.13c-43.89,8.93-72.06,35.84-82.08,78.87-9.89,42.46,4.23,78.29,38.51,105.38,20,15.83,43.71,21.25,68.85,21.24Zm.49-506.1v.16q-138,0-276,0c-30.25,0-56.14,10.14-76.82,32.34C98.33,361,88,389,92.51,420.93c7.78,54.82,50.59,91.3,106,91.31q275,0,550.05-.24a113,113,0,0,0,22.31-2.33c55.9-11.45,91.58-64.89,81.12-121.19-6.47-34.81-37.66-75.58-82.09-81.28-16.27-2.09-32.88-2-49.34-2.06Q596.8,304.87,473,305.06ZM111.29,231.67c2.2-.76,3.3-1.06,4.33-1.52,26.08-11.66,53.39-17,82-17q277.23.18,554.45.06c19.65,0,38.77,2.93,57.27,9.76,7.85,2.89,15.85,5.36,24,8.1a20.34,20.34,0,0,0,0-2.13c-4.06-26.32-7.57-52.74-12.33-78.93-5.15-28.27-32.34-53.15-60.39-55.53-20.22-1.72-40.56-3-60.84-3-110.65-.18-221.3.1-332,.2-40.49,0-81-.25-121.48.11-19.63.17-39.29,1-58.87,2.4C157,96.37,129.6,121.35,124,151.29q-3.66,19.64-6.75,39.37C115.15,204,113.36,217.29,111.29,231.67Z"/><path d="M600.91,661.46q63.26,0,126.51,0c25.75,0,45.67,18.75,46.93,43,1.42,27.11-18.6,47-44.29,48.71-1.66.11-3.33.13-5,.13-81.17,0-162.35.11-243.52-.14-8.55,0-17.48-.9-25.56-3.5-19.95-6.44-31.05-26.12-28.86-48.83,1.79-18.66,17.72-35.45,37.37-38.39,8.17-1.23,16.6-1.08,24.91-1.11,37.17-.1,74.34,0,111.5,0Z"/><path d="M170.87,707a45.65,45.65,0,0,1,45.86-45.65c25.88,0,46.33,20.82,46.13,47-.18,24.87-21.29,45.36-46.49,45.12C190.73,753.2,170.71,732.76,170.87,707Z"/><path d="M602.53,362.73H726c16.24,0,30.35,5.07,39.85,18.81,10.39,15,11.84,31.36,3.59,47.74s-22.14,24.83-40.28,24.87q-128.21.35-256.41.07c-24.07,0-43.54-17.69-45.8-41-2.31-23.91,12.84-44.73,36.22-49.45a63.6,63.6,0,0,1,12.42-1Q539.06,362.67,602.53,362.73Z"/><path d="M216.27,454.25c-25.54,0-45.33-20.4-45.25-46.59.07-24.88,20.39-44.73,46-44.92s45.9,20.36,45.86,46.09C262.83,434.18,242.21,454.28,216.27,454.25Z"/></g></g></svg>
                </div>
                <div class="video-btn btn spacing" @click="visitVideoCreate" v-show="isFreeVideoShortcutEnable">
                    <svg width="20" height="21" viewBox="0 0 1024 853.52" xmlns="http://www.w3.org/2000/svg">
                        <g id="Layer_2" data-name="Layer 2">
                            <g id="Layer_1-2" data-name="Layer 1">
                                <path
                                    d="M1024,158.76v536c-.3,1.61-.58,3.21-.92,4.81-2.52,12-3.91,24.43-7.76,36-23.93,72-88.54,117.91-165.13,117.92q-338.19,0-676.4-.1a205.81,205.81,0,0,1-32.3-2.69C76,840.18,19.81,787.63,5,723.14c-2.15-9.35-3.36-18.91-5-28.38v-537c.3-1.26.66-2.51.89-3.79,1.6-8.83,2.52-17.84,4.85-26.48C26.32,51.12,93.47.05,173.29,0Q512,0,850.72.13a200.6,200.6,0,0,1,31.8,2.68C948.44,13.47,1004,65.66,1019.09,130.88,1021.21,140.06,1022.39,149.46,1024,158.76ZM384,426.39c0,45.66-.09,91.32,0,137,.07,24.51,19.76,43.56,43.38,42.47,8.95-.42,15.83-5.3,23.06-9.86q69.25-43.74,138.74-87.11,40.63-25.42,81.44-50.6c23.18-14.34,23.09-49-.25-63.14-3.27-2-6.69-3.72-9.93-5.74q-30.08-18.81-60.08-37.69Q522.2,302.46,444,253.2a34.65,34.65,0,0,0-26.33-4.87c-19.87,4.13-33.64,21.28-33.68,42.09Q383.9,358.42,384,426.39Z" />
                            </g>
                        </g>
                    </svg>
                    <svg width="21" height="21" v-if="false" viewBox="0 0 938.37 768" xmlns="http://www.w3.org/2000/svg"><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><path d="M128.18,0h684c4.34.82,8.7,1.57,13,2.47,67.51,13.94,113.13,70,113.14,139.05q0,242.89-.18,485.78c0,11.87-1.19,24.15-4.36,35.53-14.77,53-48.46,87.6-102.16,101.65-7,1.82-14.3,2.38-21.47,3.52h-683c-3.38-.63-6.75-1.38-10.16-1.87C56.28,757.42,6.29,705.05,1.4,643.73-.31,622.36.08,600.79.07,579.32q-.15-218.21,0-436.4a177.52,177.52,0,0,1,2.17-27.33c8.54-54.39,50.4-99.27,104-111.68C113.47,2.23,120.86,1.29,128.18,0Zm340,85.17q-163,0-326,0c-13.71,0-26.52,2.76-37.26,11.8-14.39,12.14-20,28.14-20,46.54Q85,384,85,624.41c0,2.17.06,4.33.15,6.5,1.11,25.76,20.24,47.73,45.77,51,11.64,1.5,23.59.86,35.4.87q83.24.11,166.47,0H798.24c9.45,0,18.54-1.47,26.88-6.34,19.56-11.43,28.25-28.73,28.25-51q-.06-241.71,0-483.42c0-34.37-22.8-56.87-57.16-56.87Z"/><path d="M320,384q0-73.74,0-147.48c0-26,18.5-45.22,43.26-44.05A50.69,50.69,0,0,1,385.44,199q126.85,73.4,253.23,147.61c30.38,17.84,30.08,57.37-.29,75.13Q512.5,495.31,386.44,568.61c-23.06,13.42-49.17,7.06-61-14.55C321.11,546.25,320,537.77,320,529Q320.09,456.48,320,384Zm85.59-75V459l128.5-75Z"/></g></g></svg>
                </div>
                <div class="module-btn btn spacing" @click="visitModulesSetting" v-show="isModulesSettingShortcutEnable">
                    <svg width="19" height="19" viewBox="0 0 853.51 926.34" xmlns="http://www.w3.org/2000/svg">
                        <g id="Layer_2" data-name="Layer 2">
                            <g id="Layer_1-2" data-name="Layer 1">
                                <path
                                    d="M853.49,463.39q0,87.5-.06,175c0,8.81-.12,17.73-1.44,26.41-4,26.08-17.42,46.35-40.26,59.51-33.6,19.35-67.6,38-101.49,56.87Q593.06,846.32,475.85,911.42c-16.89,9.42-34.3,16-54.07,14.79-14.86-.89-28.22-6.06-41-13.15q-165.68-92-331.35-184C29,717.79,13.33,702.65,5.18,680.34,1,668.86.08,656.93.07,644.93Q0,463.45,0,282c0-20.08,3.66-39,15.44-55.83,9-12.79,21-21.6,34.42-29q165.22-91.77,330.42-183.6C396.3,4.6,413.06-1,431.71.16a84.85,84.85,0,0,1,36.11,10.58Q536.23,48.5,604.55,86.45q98,54.4,196,108.87c14.83,8.23,28.6,17.49,38.31,32,11.23,16.79,14.66,35.37,14.63,55.08q-.13,90.49,0,181ZM383.72,816.85c.12-2,.27-3.43.27-4.87q0-159.72.09-319.44c0-3.33-1.14-5-4-6.55Q235.12,405.59,90.24,325c-1.33-.74-2.73-1.38-4.74-2.39v5q0,158.22-.12,316.45c0,6,2.31,8.68,7.15,11.37q143.28,79.34,286.41,159C380.35,815.18,381.81,815.87,383.72,816.85ZM768,322.64c-2.09,1.06-3.27,1.61-4.4,2.24Q618.67,405.39,473.71,485.82c-3.22,1.79-4.29,3.73-4.29,7.37q.15,159,.08,318v5.91c2.14-1.08,3.47-1.69,4.74-2.4q142.95-79.42,286-158.72c5.86-3.24,7.92-6.79,7.9-13.47q-.3-157-.12-314ZM722.58,250c-1.11-.8-1.49-1.14-1.93-1.38Q575.93,168.22,431.27,87.74c-4.23-2.35-7.06-1-10.48.89q-143,79.45-286,158.85c-1.19.66-2.29,1.48-3.86,2.5l6.16,3.46q142.31,79.05,284.57,158.23c3.89,2.17,6.59,2,10.32-.12q128.26-71.44,256.65-142.66C699.86,262.68,711,256.43,722.58,250Z" />
                            </g>
                        </g>
                    </svg>
                </div>
                <div class="plugin-btn btn spacing" @click="visitPlugins" v-show="isPluginsSettingShortcutEnable">
                    <svg width="19" height="19" viewBox="0 0 918.34 919" xmlns="http://www.w3.org/2000/svg">
                        <g id="Layer_2" data-name="Layer 2">
                            <g id="Layer_1-2" data-name="Layer 1">
                                <path
                                    d="M684.21,919h-227a5.25,5.25,0,0,0-1.72-.77,109.28,109.28,0,0,1-58.19-19.77c-1.06-.74-3.73-.28-5,.58a105,105,0,0,1-37.14,16.4c-7.24,1.56-14.64,2.4-22,3.56h-58a34.39,34.39,0,0,0-5.28-.8q-59.25-.06-118.5,0a33.64,33.64,0,0,0-5.22.8h-43c-2.75-.41-5.5-.84-8.26-1.23C38.53,909.8.26,865.87.22,808.85Q.15,698.12.23,587.38c0-20.84,5.46-40.27,17.24-57.47,3.53-5.16,3.49-8.6.23-13.48C4.6,496.83-.19,475.18,0,451.57c.57-70.65.18-141.31.24-212,0-5.81.31-11.65.89-17.44,5-49.57,48.25-90.89,98-93.2,16-.75,32-.76,48-.76q92.24,0,184.46.38a106.71,106.71,0,0,1,20.34,2c51.28,10.27,86.34,53.34,86.35,105.77q0,111.48-.08,223c0,6.12-1.09,12.24-1.71,18.36-.17,1.7-.47,3.39-.59,4.19,13.24-.46,26-1.26,38.79-1.29q104-.18,208-.05c59.78,0,107.24,46.68,107.53,106.53q.55,112.49,0,225c-.18,51.14-35.55,93.92-85.45,104C697.94,917.39,691,918,684.21,919ZM572.37,832.49q51.5,0,103,0c2.32,0,4.66-.34,7-.22,12.22.64,22-8.72,21.94-23.57-.15-72.33-.06-144.65-.11-217a44.4,44.4,0,0,0-.93-8.91c-1.84-9-7.45-14.31-16.49-15.74a51.69,51.69,0,0,0-8-.54q-108,0-216,0c-16.64,0-24.62,7.93-24.61,24.4q.07,107.73.17,215.47c0,18.63,7.43,26.11,26,26.11Zm-352.86-352h104c2,0,4,0,6-.17,15.82-1.23,22.7-8.55,22.71-24.34q0-108.24,0-216.48c0-17.24-7.78-25-25.07-25h-216c-17.26,0-25,7.75-25,25.1V455.09c0,17.16,7.2,24.68,24.31,25.38,1.49.06,3,0,4.5,0ZM86.21,699.82v104c0,22,6.68,28.68,28.53,28.68h209c1.66,0,3.33,0,5-.07,16.69-1.1,23.49-8.38,23.51-25.16q0-30.25,0-60.5,0-78,0-156c0-7.57-1.43-14.66-7.78-19.68-5-3.93-10.92-4.61-17-4.61H110.93c-16.92,0-24.71,7.85-24.72,24.83Q86.2,645.58,86.21,699.82Z" />
                                <path
                                    d="M816.21,0C821.58.88,827,1.56,832.3,2.68,883,13.34,918,55.75,918.15,107.38q.35,112.71,0,225.42c-.23,57-46.23,104.42-103,105.19-60.79.82-121.6.18-182.4.17-17.82,0-35.68.8-53.44-.23-51.2-3-93.51-44.34-98.2-95.25-.55-6-.86-12-.86-17.94q-.09-107.71,0-215.43C480.21,51.05,521.48,6,579.49.83A13.51,13.51,0,0,0,582.21,0Zm16,219.35V111.89c0-17.66-7.57-25.37-25.12-25.37q-108.45,0-216.91,0c-15.9,0-24,8.13-24,24V328.45c0,15.45,7.6,23.24,23.2,23.69,7.32.21,14.65.34,22,.34q96.21,0,192.42,0c2.16,0,4.33-.06,6.48-.23,14.92-1.14,21.93-8.63,21.93-23.45Q832.23,274.08,832.21,219.35Z" />
                            </g>
                        </g>
                    </svg>
                </div>
                <div class="theme-btn btn spacing" @click="visitThemes" v-show="isThemesShortcutEnable">
                    <svg width="19" height="19" viewBox="0 -10 940.66 926.15" xmlns="http://www.w3.org/2000/svg">
                        <g id="Layer_2" data-name="Layer 2">
                            <g id="Layer_1-2" data-name="Layer 1">
                                <path
                                    d="M697.39,926.15H245.3a14.77,14.77,0,0,0-2.77-.86C190,919.2,153.12,877.8,153.12,824.84V547.51c-3-.55-5.23-1-7.52-1.4-36.41-6.3-72.85-12.4-109.21-19C14.07,523.11.15,506.26.13,483.52c-.1-99-.27-198,.09-297,.12-34.94,16-61.27,47.23-77.57,8.39-4.36,17.28-7.79,26-11.44Q183.53,51.59,293.6,5.66c21.22-8.91,39.62-5.77,56.55,9.91C383.38,46.36,417,76.76,450.41,107.31c6.95,6.35,13.95,12.66,20.93,19l4.16-3.78,120.8-110c14.74-13.43,31.27-16,49.46-8,11,4.82,21.9,9.74,32.84,14.63,70.76,31.66,141.65,63,212.23,95.09,31.49,14.3,49.13,39.56,49.37,74.25.71,98.49.41,197,.35,295.47,0,22.47-14,39.1-36.08,43.19-24.55,4.54-49.18,8.64-73.78,12.93l-41.12,7.12c0,2.14,0,3.95,0,5.76.11,13.49.34,27,.32,40.48q-.1,117.24-.32,234.47c-.07,41-27.26,79.11-66.15,92.07C715,922.8,706.08,924.13,697.39,926.15ZM853.58,447.77v-5.88q0-121.75.14-243.52c0-4.72-1.71-6.59-5.67-8.35Q743.41,143.48,638.89,96.59c-2.86-1.28-4.56-1.15-6.89,1q-26.61,24.59-53.46,48.91c-25.6,23.35-51.13,46.77-76.85,70C490.73,226.38,477.91,231,463,228c-10-2-17.92-7.62-25.29-14.35q-63.44-58-126.93-115.94c-2.46-2.24-4.38-3.12-7.81-1.68Q197.31,140.24,91.49,184.09c-3.58,1.48-4.47,3.39-4.46,7q.15,125.51.08,251v5.48l66,11.49v-6.36c0-45-.07-90,0-135,0-21.06,15.76-39.07,36.64-42.46,20.31-3.29,40.76,8.44,47,27.95a75.22,75.22,0,0,1,3.2,22.6q.27,247.77.14,495.54a51.79,51.79,0,0,0,.21,6.48c.71,5.62,3.79,9.11,9.31,10.35a34.18,34.18,0,0,0,7.42.7q214.29.06,428.58,0a34.47,34.47,0,0,0,5-.24c8.14-1.19,11.59-5.11,11.89-13.37.07-1.83,0-3.67,0-5.5q.16-250.51.34-501c0-24.77,18.7-43.72,43-43.74,24.76,0,43.59,18.77,43.68,43.66q.2,58.74.34,117.49c0,7.3,0,14.59,0,22.49Z" />
                            </g>
                        </g>
                    </svg>
                </div>
                <div class="userhome-btn btn spacing" @click="() => visitUserHome()" v-show="isUserHomeShortcutEnable">
                    <svg width="21" height="21" viewBox="0 0 938.47 938.5" xmlns="http://www.w3.org/2000/svg">
                        <g id="Layer_2" data-name="Layer 2">
                            <g id="Layer_1-2" data-name="Layer 1">
                                <path
                                    d="M0,469C.33,209.53,210.36-.32,469.38,0,729.05.32,939.22,210.78,938.47,469.76c-.76,259.7-211.12,469.66-469.63,468.74C208.87,937.57-.33,728.06,0,469Zm453.81,128,.12-.34-1.95-.2c-53.39-5.09-94.44-29.95-122-76.3-14.75-24.84-23-52-27.21-80.35-4.62-31.1-6.87-62.34-.49-93.46,10.07-49.16,36-87.34,80.26-111.88,32.13-17.8,67-23.53,103.32-20.28,46.06,4.12,84.22,23.72,113.49,59.63,24.9,30.54,37.7,66,39.88,105.16,2.3,41.55-2.47,82.21-19,120.79-19.26,44.86-51.57,75.78-98.75,90.18a171.59,171.59,0,0,1-18,4.28c-6,1.14-12.07,1.77-19.36,2.8,2.76.19,4.26.35,5.75.38,39.17.82,78.23,3.08,117,8.94,33.49,5.07,66.42,12.41,97.94,25.1,27.78,11.19,53.28,25.93,73.53,48.57,2.16,2.43,4.24,4.93,6.42,7.46,100.84-141.58,96.84-361.06-57.33-502.35C576.61,46.82,340.65,52.88,196.73,198.77,51.56,345.94,60.23,558.41,153.79,687.36c2.07-2.44,4.06-4.88,6.15-7.22,23.12-25.8,52.64-41.45,84.68-52.86,50.51-18,103.12-24.68,156.28-28C418.51,598.18,436.17,597.7,453.81,596.94Zm15.45,85.56c-55,0-99.89,3.54-143.71,11.75C299.3,699.17,273.61,706,250,719c-13.9,7.67-26.18,17.11-33.23,32-1.83,3.88-1.62,6.33,1.92,9.29,86,71.89,184.71,102.35,296.12,90,74.25-8.24,140.09-37.15,198-84.26,12.85-10.45,12.94-12.24,2.41-25.61-9-11.4-20.9-19-33.75-25.16-25-12-51.65-18.4-78.78-23C558.52,684.74,513.94,682.83,469.26,682.5ZM383.5,389.86c1,11.78,1.58,23.6,3,35.32a178.07,178.07,0,0,0,4.84,24c10.64,39.94,33.24,60,72.16,62.46,39.11,2.43,67.94-13.22,81.51-52.5,9.63-27.85,11.93-56.79,7.84-85.82-3.8-26.92-16.6-49.06-40.58-63.43C495,299.51,476.06,297,456.38,299.32c-31.89,3.81-55.18,19.38-66.8,50.18C384.68,362.46,383.45,376,383.5,389.86Z" />
                            </g>
                        </g>
                    </svg>
                </div>
                <div class="setting-btn btn spacing" @click="() => visitSetting()"
                    @dblclick="() => visitSettingUpdates()" 
                    :class="{ 
                        last: !isSimpleLayoutShortcutEnable, 
                        newflag: hasNewRelease && isUpdatesHintShowEnable,
                    }">
                    <svg width="21" height="20" viewBox="0 0 19.53 18" xmlns="http://www.w3.org/2000/svg">
                        <g id="Layer_2" data-name="Layer 2">
                            <g id="Layer_1-2" data-name="Layer 1">
                                <path class="cls-1"
                                    d="M.32,10.34a3,3,0,0,1,0-2.68l3-6A3,3,0,0,1,6,0h7.53a3,3,0,0,1,2.68,1.66l3,6a3,3,0,0,1,0,2.68l-3,6A3,3,0,0,1,13.53,18H6a3,3,0,0,1-2.68-1.66ZM2.11,8.55a1,1,0,0,0,0,.9l3,6A1,1,0,0,0,6,16h7.53a1,1,0,0,0,.89-.55l3-6a1,1,0,0,0,0-.9l-3-6A1,1,0,0,0,13.53,2H6a1,1,0,0,0-.89.55ZM7.76,9a2,2,0,1,0,2-2A2,2,0,0,0,7.76,9Zm2,4a4,4,0,1,1,4-4A4,4,0,0,1,9.76,13Z" />
                            </g>
                        </g>
                    </svg>
                </div>
                <div class="switch-layout-btn btn" @click="switchToSmallLayout" v-show="isSimpleLayoutShortcutEnable">
                    <svg width="20" height="18.3" viewBox="0 0 1019 1019" xmlns="http://www.w3.org/2000/svg">
                        <g id="Layer_2" data-name="Layer 2">
                            <g id="Layer_1-2" data-name="Layer 1">
                                <path
                                    d="M0,841V50a65,65,0,0,0,2.75-6.86C8.72,22.15,22.41,9,43.22,3c3-.86,5.85-2,8.78-3H837a28.45,28.45,0,0,0,4.46,1.9c31.14,7.47,47.71,28.49,47.71,60.65V447.16h6.12c21,0,42-.07,63,0,29.91.13,51.36,17,58.66,45.87.52,2,1.37,4,2.06,5.95V968a32.14,32.14,0,0,0-2.06,4.91c-5.41,22.53-19.19,37-41.49,43.25-4.41,1.23-9,1.91-13.45,2.84H503a24.12,24.12,0,0,0-3.77-.86c-31.82-2.43-54.36-26.64-54.39-58.5,0-21.49,0-43,0-64.46,0-1.75-.14-3.5-.24-5.67h-7.5l-377.22-.35c-28.4,0-48.4-14.83-56.88-41.95A46.47,46.47,0,0,0,0,841Zm447-71V506c0-34.45,20.39-57.11,54.53-60,10.76-.93,21.62-.92,32.44-.93q114.74-.1,229.48,0h6.06V118.23H118.2V770ZM564.55,565V900.68H900.66V565Z" />
                            </g>
                        </g>
                    </svg>
                </div>
                <div class="win-ctl-wrap" v-show="useWindowsStyleWinCtl">
                    <WinNonMacOSControlBtn :isMaximized="isMaxScreen"></WinNonMacOSControlBtn>
                </div>
            </div>
        </div>
    </div>
</template>

<style>
.classic-main-top {
    display: flex;
    flex-direction: row;
    align-items: center;
    height: var(--main-top-height);
    -webkit-app-region: drag;
    padding-left: 33px;
}

.classic-main-top .spacing {
    margin-right: 18px;
}

.classic-main-top > .center {
    flex: 5;
    display: flex;
    flex-direction: row;
    align-items: center;
    position: relative;
    
}

.classic-main-top .action {
    position: absolute;
    /*right: 33px;*/
    right: 28px;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: flex-end;
    width: calc(100% - 59px);
}

.classic-main-top .action .btn {
    display: flex;
    align-items: center;
}

.classic-main-top svg {
    fill: var(--button-icon-btn-color);
    cursor: pointer;
    -webkit-app-region: none;
    background-color: transparent;
}

.classic-main-top svg:hover {
    fill: var(--content-highlight-color);
}

.classic-main-top .radio-playlist-btn .radio-btn {
    transform: translateY(1px) scale(0.973);
}

.classic-main-top .win-ctl-wrap {
    display: flex;
    align-items: center;
}

/*
.classic-main-top .radio-playlist-btn .playlist-btn {
    transform: translateY(1px);
}

.classic-main-top .cloud-storage-btn {
    transform: translateY(1px);
}

.classic-main-top .module-btn {
    transform: translateY(1px);
}
*/

.classic-main-top .theme-native-mode-btn,
.classic-main-top .radio-playlist-btn .playlist-btn,
.classic-main-top .cloud-storage-btn,
.classic-main-top .module-btn,
.classic-main-top .video-btn {
    transform: translateY(1px);
}

.classic-main-top .setting-btn {
    position: relative;
}

.classic-main-top .setting-btn.newflag::after {
    content: '';
    background: var(--content-new-color);
    border: 1px solid #ffffff18;
    border-radius: 10em;
    width: 5px;
    height: 5px;
    position: absolute;
    right: -4px;
    top: -4px;
}

.classic-main-top .setting-btn.last {
    margin-right: 0px !important;
}

.classic-main-top > .search-bar {
    flex: 2;
}

.classic-main-top > .search-bar .keyword {
    min-width: 168px;
    width: 88%;
}

.classic-main-top > .search-bar .extra-action {
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: flex-start;
}

.classic-main-top > .search-bar .extra-action svg {
    fill: var(--searchbar-clear-btn-icon-color);
    padding: 0px 3px;
    margin-right: 5px;
    cursor: pointer;
    transform: scale(1.05) rotate(90deg);
}

.classic-main-top > .search-bar .extra-action svg:hover {
    fill: var(--content-highlight-color);
    transform: scale(1.15) rotate(90deg);
}
</style>